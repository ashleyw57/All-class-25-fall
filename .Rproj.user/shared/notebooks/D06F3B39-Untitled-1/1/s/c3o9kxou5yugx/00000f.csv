"0","#| label: tbl1"
"0","#| tbl-cap: ""Table 1. Baseline Characteristics of Patients"""
"0",""
"0","library(gtsummary)"
"0","library(flextable)"
"0",""
"0","# 保证三列是 No/Yes 的二分类因子（你已确认原始是 'Y'/'N'）"
"0","to_yesno_factor <- function(x) {"
"0","  x <- as.character(x)"
"0","  out <- dplyr::case_when("
"0","    x == ""Y"" ~ ""Yes"","
"0","    x == ""N"" ~ ""No"","
"0","    TRUE     ~ NA_character_"
"0","  )"
"0","  factor(out, levels = c(""No"", ""Yes""))"
"0","}"
"0",""
"0","patient_tbl <- patient %>%"
"0","  dplyr::mutate("
"0","    race           = factor(race),"
"0","    ethnicity      = factor(ethnicity),"
"0","    financialclass = factor(financialclass),"
"0","    hypertension   = to_yesno_factor(hypertension),"
"0","    CHF            = to_yesno_factor(CHF),"
"0","    diabetes       = to_yesno_factor(diabetes)"
"0","  )"
"0",""
"0","# 关键：把二分类变量声明为 ""dichotomous""，并指定只显示 ""Yes"""
"0","tbl1 <- tbl_summary("
"0","  data    = patient_tbl,"
"0","  include = c(race, ethnicity, financialclass, hypertension, CHF, diabetes),"
"0","  type    = list(hypertension ~ ""dichotomous"","
"0","                 CHF          ~ ""dichotomous"","
"0","                 diabetes     ~ ""dichotomous""),"
"0","  value   = list(hypertension ~ ""Yes"","
"0","                 CHF          ~ ""Yes"","
"0","                 diabetes     ~ ""Yes""),"
"0","  statistic = list("
"0","    all_categorical() ~ ""{n} ({p}%)"","
"0","    all_dichotomous() ~ ""{n} ({p}%)""  # 明确二分类的显示格式"
"0","  ),"
"0","  missing = ""no"","
"0","  label = list("
"0","    race           ~ ""Race"","
"0","    ethnicity      ~ ""Ethnicity"","
"0","    financialclass ~ ""Financial Class"","
"0","    hypertension   ~ ""Hypertension, n (%)"","
"0","    CHF            ~ ""Congestive Heart Failure, n (%)"","
"0","    diabetes       ~ ""Diabetes, n (%)"""
"0","  )"
"0",") |>"
"0","  bold_labels() |>"
"0","  as_flex_table() |>"
"0","  autofit()"
"0",""
"0","tbl1   # 确保最后输出对象"
