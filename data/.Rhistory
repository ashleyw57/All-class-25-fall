# table one
library(tableone)
library(survival)
data(pbc)
CreateTableOne(data = pbc)
?dput
dput(names(pbc))
dput(names(pbc))
myVars <- c("id", "time", "status", "trt", "age", "sex", "ascites", "hepato",
"spiders", "edema", "bili", "chol", "albumin", "copper", "alk.phos",
"ast", "trig", "platelet", "protime", "stage")
carVars <- c("status", "trt", "ascites", "hepato",
"spiders", "edema", "stage" )
CreateTableOne(vars = myVars, data =pbc, factorVars = catVars )
catVars <- c("status", "trt", "ascites", "hepato",
"spiders", "edema", "stage" )
CreateTableOne(vars = myVars, data =pbc, factorVars = catVars )
CreateTableOne(vars = myVars, data =pbc )
CreateTableOne(vars = myVars, data =pbc, factorVars = catVars )
tab2 <- CreateTableOne(vars = myVars, data =pbc, factorVars = catVars )
print(tab2, showAllLevels = TRUE, formatOptions = list(big.mark = ","))
summary(tab2)
biomarkers <- ("bili","chol","copper","alk.phos","ast","trig","protime")
biomarkers <- ("bili", "chol","copper","alk.phos","ast","trig","protime")
biomarkers <- c("bili","chol","copper","alk.phos","ast","trig","protime")
print(tab2, nonnormal = biomarkers, formatOptions = list(big.mark = ","))
print(tab2, nonnormal = biomarkers, showAllLevels = TRUE, formatOptions = list(big.mark = ","))
tab3 <- CreateTableOne(vars = myVars, data = pbc, strata = "trt", factorVars = catVars)
print(tab3, nonnormal = biomarkers, showAllLevels = TRUE, formatOptions = list(big.mark = ","))
print(tab3, nonnormal = biomarkers, exact = "stage", smd = TRUE)
print(tab3, nonnormal = biomarkers, exact = "stage", quote = TRUE, noSpaces = TRUE)
tab3Mat <- print(tab3, nonnormal = biomarkers, exact = "stage", quote = FALSE, noSpaces = TRUE, printToggle = FALSE)
write.csv(tab3Mat, file = "myVars.cvs")
?rbinom
dbinom(0, 5,0.25)
dbinom(4, 5, 0.25) + dbinom(5, 5, 0.25)
1 - pbinom(3， 5， 0.25)
1 - pbinom(3, 5, 0.25)
pbinom(3, 5, 0.25, lower.tail = FALSE)
#create HTML
library(boot)
#create HTML
install.packages(survival)
library(survival)
library(boot)
melanoma2 <- melanoma
melanoma2$status
melanoma2$status <- factor(malanoma2$status,
levels = c(2, 1, 3),
labels = c("Alive",
"Melanoma death",
"Non-melanoma death"))
melanoma2$status
melanoma2$status <- factor(malanoma2$status,
levels = c(2, 1, 3),
labels = c("Alive",
"Melanoma death",
"Non-melanoma death"))
melanoma2$status <- factor(melanoma2$status,
levels = c(2, 1, 3),
labels = c("Alive",
"Melanoma death",
"Non-melanoma death"))
melanoma2$status <- factor(melanoma2$status,
levels = c(2, 1, 3),
labels = c("Alive",
"Melanoma death",
"Non-melanoma death")
labels = TRUE)
x_ord <- factor(c("low", "medium", "high"),
levels = c("low", "medium", "high"),
ordered = TRUE)
x_ord
x_ord <- factor(c("low", "medium", "high"),
levels = c("low", "medium", "high"))
x_ord
table1(~ factor(sex) + age + factor(ulcer) + thickness | status, data=melanoma2)
library(boot)
melanoma2 <- melanoma
melanoma2$status
melanoma2$status <- factor(melanoma2$status,
levels = c(2, 1, 3),
labels = c("Alive",
"Melanoma death",
"Non-melanoma death")
labels = TRUE)
table1(~ factor(sex) + age + factor(ulcer) + thickness | status, data=melanoma2)
library(table1)
install.packages(table1)
install.packages(table1)
install.packages("table1")
library(table1)
table1(~ factor(sex) + age + factor(ulcer) + thickness | status, data=melanoma2)
？table1()
？table1
?table1
# 把 ulcer 转换成因子
melanoma2$ulcer <- factor(melanoma2$ulcer,
levels = c(0, 1),
labels = c("No ulcer", "Ulcer present"))
# --- 双层分层：先按 status，再按 ulcer ---
table1(~ age + sex + thickness | status + ulcer,
data = melanoma2)
melanoma2$sex <-
factor(melanoma2$sex, levels=c(1,0),
labels=c("Male",
"Female"))
melanoma2$ulcer <-
factor(melanoma2$ulcer, levels=c(0,1),
labels=c("Absent",
"Present"))
label(melanoma2$sex)       <- "Sex"
label(melanoma2$age)       <- "Age"
label(melanoma2$ulcer)     <- "Ulceration"
label(melanoma2$thickness) <- "Thicknessᵃ"
units(melanoma2$age)       <- "years"
units(melanoma2$thickness) <- "mm"
caption  <- "Basic stats"
footnote <- "ᵃ Also known as Breslow thickness"
table1(~ sex + age + ulcer + thickness | status, data=melanoma2,
overall=c(left="Total"), caption=caption, footnote=footnote)
melanoma2$sex <-
factor(melanoma2$sex, levels=c(0,1),
labels=c("Male",
"Female"))
melanoma2$ulcer <-
factor(melanoma2$ulcer, levels=c(0,1),
labels=c("Absent",
"Present"))
label(melanoma2$sex)       <- "Sex"
label(melanoma2$age)       <- "Age"
label(melanoma2$ulcer)     <- "Ulceration"
label(melanoma2$thickness) <- "Thicknessᵃ"
units(melanoma2$age)       <- "years"
units(melanoma2$thickness) <- "mm"
caption  <- "Basic stats"
footnote <- "ᵃ Also known as Breslow thickness"
table1(~ sex + age + ulcer + thickness | status, data=melanoma2,
overall=c(left="Total"), caption=caption, footnote=footnote)
table(melanoma2$sex)
melanoma2$sex <-
factor(melanoma2$sex, levels=c(1,0),
labels=c("Male",
"Female"))
table(melanoma2$sex)
table(melanoma$sex)
melanoma2$sex <-
factor(melanoma2$sex, levels=c(1,0),
labels=c("Male",
"Female"))
melanoma2$ulcer <-
factor(melanoma2$ulcer, levels=c(0,1),
labels=c("Absent",
"Present"))
label(melanoma2$sex)       <- "Sex"
label(melanoma2$age)       <- "Age"
label(melanoma2$ulcer)     <- "Ulceration"
label(melanoma2$thickness) <- "Thicknessᵃ"
units(melanoma2$age)       <- "years"
units(melanoma2$thickness) <- "mm"
caption  <- "Basic stats"
footnote <- "ᵃ Also known as Breslow thickness"
table1(~ sex + age + ulcer + thickness | status, data=melanoma2,
overall=c(left="Total"), caption=caption, footnote=footnote)
melanoma2 <- melanoma
melanoma2$status
melanoma2$status <- factor(melanoma2$status,
levels = c(2, 1, 3),
labels = c("Alive",
"Melanoma death",
"Non-melanoma death")
labels = TRUE)
x_ord <- factor(c("low", "medium", "high"),
levels = c("low", "medium", "high"))
melanoma2$status <- factor(melanoma2$status,
levels = c(2, 1, 3),
labels = c("Alive",
"Melanoma death",
"Non-melanoma death")
labels = TRUE)
table(melanoma$sex, useNA="ifany")
table1(~ sex + age + ulcer + thickness | status, data=melanoma2, caption=caption, footnote=footnote)
table1(~ sex + age + ulcer + thickness | status, data=melanoma2, overall = c(right = "Total", caption=caption, footnote=footnote)
table1(~ sex + age + ulcer + thickness | status, data=melanoma2, overall = c(right = "Total", caption=caption, footnote=footnote)
caption  <- "Basic stats"
caption  <- "Basic stats"
caption  <- "Basic stats"
caption  <- "Basic stats"
footnote <- "ᵃ Also known as Breslow thickness"
table1(~ sex + age + ulcer + thickness | status, data=melanoma2, overall = c(right = "Total", caption=caption, footnote=footnote)
table(melanoma$sex)
# --- 双层分层：先按 status，再按 ulcer ---
table1(~ age + sex + thickness | status + ulcer,
data = melanoma2)
# 把 ulcer 转换成因子
melanoma2$ulcer <- factor(melanoma2$ulcer,
levels = c(0, 1),
labels = c("No ulcer", "Ulcer present"))
# --- 双层分层：先按 status，再按 ulcer ---
table1(~ age + sex + thickness | status + ulcer,
data = melanoma2)
melanoma2$sex <-
factor(melanoma2$sex, levels=c(1,0),
labels=c("Male",
"Female"))
melanoma2$ulcer <-
factor(melanoma2$ulcer, levels=c(0,1),
labels=c("Absent",
"Present"))
label(melanoma2$sex)       <- "Sex"
label(melanoma2$age)       <- "Age"
label(melanoma2$ulcer)     <- "Ulceration"
label(melanoma2$thickness) <- "Thicknessᵃ"
units(melanoma2$age)       <- "years"
units(melanoma2$thickness) <- "mm"
caption  <- "Basic stats"
footnote <- "ᵃ Also known as Breslow thickness"
table1(~ sex + age + ulcer + thickness | status, data=melanoma2, overall = c(right = "Total", caption=caption, footnote=footnote)
table(melanoma$sex)
table1(~ sex + age + ulcer + thickness | status, data=melanoma2, overall = c(right = "Total", caption=caption, footnote=footnote)
table1
table1(~ sex + age + ulcer + thickness | status, data=melanoma2, overall = c(right = "Total", caption=caption, footnote=footnote)
caption  <- "Basic stats"
footnote <- "ᵃ Also known as Breslow thickness"
table1(~ sex + age + ulcer + thickness | status, data=melanoma2, overall = c(right = "Total", caption=caption, footnote=footnote)
table1(~ sex + age + ulcer + thickness | status, data=melanoma2, overall = c(right = "Total", caption = caption, footnote = footnote)
table1(~ sex + age + ulcer + thickness | status, data=melanoma2, overall = c(right = "Total", caption <- caption, footnote <- footnote)
# --- Packages ---
# install.packages(c("table1", "survival", "dplyr"))
library(table1)
install.packages(c("table1", "survival", "dplyr"))
+ library(table1)
install.packages(c("table1", "survival", "dplyr"))
+ library(table1)
library(table1)
table1(~ sex + age + ulcer + thickness | status, data=melanoma2, overall = c(right = "Total", caption <- caption, footnote <- footnote)
b
b
table1(~ sex + age + ulcer + thickness | status,
data=melanoma2,
overall = c(right = "Total"),
caption <- caption,
footnote <- footnote)
table1(~ sex + age + ulcer + thickness | status,
data=melanoma2,
overall = c(right = "Total"),
caption = caption,
footnote = footnote)
table1(~ sex + age + ulcer + thickness | status,
data=melanoma2,
overall = c(left = "Total"),
caption = caption,
footnote = footnote)
# --- Packages ---
# install.packages(c("table1", "survival", "dplyr"))
library(table1)
library(survival)
library(dplyr)
# --- Data prep: labels/units & nicer factors ---
melanoma2 <- survival::melanoma |>
mutate(
# Be careful: levels must match original coding!
sex   = factor(sex,   levels = c(1, 0), labels = c("Male", "Female")),   # 分类变量 labels
ulcer = factor(ulcer, levels = c(0, 1), labels = c("Absent", "Present")),
status = factor(status, levels = c(2, 1, 3),
labels = c("Alive", "Melanoma", "Non-melanoma"))
)
# --- Data prep: labels/units & nicer factors ---
melanoma2 <- survival::melanoma |>
mutate(
# Be careful: levels must match original coding!
sex   = factor(sex,   levels = c(1, 0), labels = c("Male", "Female")),   # 分类变量 labels
ulcer = factor(ulcer, levels = c(0, 1), labels = c("Absent", "Present")),
status = factor(status, levels = c(2, 1, 3),
labels = c("Alive", "Melanoma", "Non-melanoma"))
)
labels <- list(
variables=list(sex="Sex",
age="Age (years)",
ulcer="Ulceration",
thickness="Thicknessᵃ (mm)"),
groups=list("", "", "Death"))
?list
# Remove the word "death" from the labels, since it now appears above
levels(melanoma2$status) <- c("Alive", "Melanoma", "Non-melanoma")
table1(~ sex + age + ulcer + thickness | status,
data=melanoma2,
overall = c(left = "Total"),
caption = caption,
footnote = footnote)
labels <- list(
variables=list(sex="Sex",
age="Age (years)",
ulcer="Ulceration",
thickness="Thicknessᵃ (mm)"),
groups=list("", "", "Death"))
levels(melanoma2$status) <- c("Alive", "Melanoma", "Non-melanoma")
ultra <- read.csv("/Users/seventh/Desktop/All class-25 fall/702/ultrarunning.csv")
summary(ultra$pb100k_dec)
hist(ultra$pb100k_dec)
boxplot(ultra$pb100k_dec)
summary(ultra$teique_sf)
hist(ultra$teique_sf)
nrow(ultra)
ultra$exclude <- ifelse( is.na(ultra$teique_sf) |
is.na(ultra$pb100k_dec), 0, 1)
ultra$excludeF <- factor(ultra$exclude,
levels = c(0,1),
labels = c ("included", "excluded"))
table(ultra$excludeF)
total_n <- nrow(ultra)
sum(is.na(ultra$teique_sf))
sum(is.na(ultra$pb100k_dec))
analytic <- subset(ultra, !is.na(teique_sf) & !is.na(pb100k_dec))
analytic_n <- nrow(analytic)
removed_n <- total_n - analytic_n
cat("Total sample:", total_n, "\n",
"Analytic dataset:", analytic_n, "\n",
"Removed:", removed_n, "\n")
install.packages("tableone")
install.packages("tableone")
library(tableone)
# 定义 included (是否进入分析数据集)
ultra$included <- ifelse(!is.na(ultra$teique_sf) & !is.na(ultra$pb100k_dec), "Included", "Excluded")
# 检查分布
table(ultra$included)
# 生成 Table 1
vars <- c("pb_surface", "pb_elev", "avg_km", "steu_b", "stem_b")
library(tableone)
tab1 <- CreateTableOne(vars = vars, strata = "included", data = ultra, test = FALSE, smd = TRUE)
print(tab1, smd = TRUE)
# 提取 SMD 值
smd_values <- ExtractSmd(tab1)
print(smd_values)
ultra$included <- ifelse(!is.na(ultra$teique_sf) & is.na(ultra$pb100k_dec), 1, 0)
vars <- c("pb_surface", "pb_elev", "avg_km","steu_b","stem_b")
table(ultra$included, useNA = "ifany")
tab1 <- CreateTableOne(vars = vars, strata = "included", data = ultra, test = FALSE, smd = TRUE)
print(tab1, smd = TRUE)
ultra$exclude <- ifelse( is.na(ultra$teique_sf) |
is.na(ultra$pb100k_dec), 1, 0)
ultra$excludeF <- factor(ultra$exclude,
levels = c(0,1),
labels = c ("included", "excluded"))
table(ultra$excludeF)
#visualize
ultra <- read.csv("/Users/seventh/Desktop/All class-25 fall/702/ultrarunning.csv")
summary(ultra$pb100k_dec)
hist(ultra$pb100k_dec)
boxplot(ultra$pb100k_dec)
summary(ultra$teique_sf)
hist(ultra$teique_sf)
nrow(ultra)
ultra$exclude <- ifelse( is.na(ultra$teique_sf) |
is.na(ultra$pb100k_dec), 1, 0)
ultra$excludeF <- factor(ultra$exclude,
levels = c(0,1),
labels = c ("included", "excluded"))
table(ultra$excludeF)
View(ultra)
#analyze
class(ultra$pb_surface)
ultra$pb_surfaceF <- factor(ultra$pb_surface, levels = c(1, 2, 3, 4), labels = c("trial", "track", "road", "mix"))
table(ultra$pb_surfaceF)
class(ultra$pb_elev)
class(avg_km)
class(ultra$avg_km)
class(ultra$steu_b)
class(ultra$stem_b)
summary(ultra$steu_b)
summary(ultra$stem_b)
summary(ultra$avg_km)
summary(ultra)
library(tableone)
vars <- c("age", "sexF", "pb_surfaceF", "pb_elev", "avg_km", "steu_b", "stem_b")
comparsionTable <- CreateTableOne(vars = vars,
strata = "excludeF",
data = ultra,
test = FALSE)
vars <- c("pb_surfaceF", "pb_elev", "avg_km", "steu_b", "stem_b")
comparsionTable <- CreateTableOne(vars = vars,
strata = "excludeF",
data = ultra,
test = FALSE)
print(comparsionTable, smd = TRUE, missing = TRUE)
rm(list=ls())
library(tidyverse)
rm(list=ls())
library(tidyverse)
library(lubridate)
library(pracma)
library(eeptools)
install.packages("pracma")
library(pracma)
install.packages("eeptools")
library(eeptools)
library(tidyverse)
install.packages("here")
library(here)
library(here)
setwd("/Users/seventh/Desktop/All class-25 fall/721")
file.path <- file.choose()
file.path
setwd(dirname(file.path))
here()
here("data","penguins.cvs")
stats::lag()
library(dplyr)
stats::lag
dplyr::lag
lag()
here()
here::here("f1", "f2", "f3", "data", "penguins.csv")
library(here)
here::here()
#Option 1 to access files on your computer: Working Directory Method
getwd()
library(here)
here::here()
